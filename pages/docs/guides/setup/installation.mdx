import asset from 'next/asset'
import { withDoc } from 'app/lib'
import { Alert, Tip, Info } from 'app/components'
import Footer from './footer.mdx'

export const meta = {
  title: 'Запуск системы установки',
}

На серверах не используются графические интерфейсы, для взаимодействия используется обычный текстовый терминал.
Терминал Linux — это мощный инструмент, используя который проще и быстрее произвести настройку.

## Подключение

### Подключение к серверу по ssh

В MacOs и Linux найдите среди приложений **Terminal** и подключитесь к серверу по имени домена.
Windows воспользуйтесь `cmd`. Команда подключения `ssh`, затем имя пользователя, например `root`,
дальше `@` и следом имя сервера. Нажмите `Enter/Return`.

[[tip|Альтернативный эмулятор терминала]]
| Особенно актуально для Windows. Если обычный терминал кажется не очень удобным,
| возмользуйтесь альтернативным приложением [Hyper](https://hyper.is/).
| Работает на всех операционных системах


```bash
ssh root@домен-вашего-сервера
```

[[alert|Если не удается подключиться]]
| Проверьте регистрационные данные сервера, пользователь может быть отличным от`root`. 
| Обратитесь за помощью в сообщество Rockstat в [telegram](https://t.me/rockstats)


При первом подключении вы получите сообщение "Не удается проверить подлинность сервера / The authenticity of host ... can't be established...".
Ответьте `yes` чтобы продолжить подключение.

Если все введено правильно, будет показан диалог ввода пароля. 
Обратите внимание что при вводе нет индикации введенных символов, как будто ничего не вводится.
По завершении ввода нажмите `Enter/Return`.

```
ssh root@dr.dg03.ru

The authenticity of host 'dr.dg03.ru (142.93.139.33)' can't be established.
ECDSA key fingerprint is SHA256:bQFX2ox2wMRB/vBX2i3G8qbNzGm9aqWpa5+0KTvdvRo.
Are you sure you want to continue connecting (yes/no)? yes

root@dr.dg03.ru's password: 
```


[[tip]]
| В некоторых случаях может быть запрошено изменение пароля.
| Введите старый пароль, а затем два раза новый

После успешного ввода данных вы увидите приглашение операционной системы Linux 

```
root@rstat:~# █
```

или

```
user@front:~$ █
```

Таким образом сервер предлагает вам ввести команду.

## Донастройка системы

### Дополнительный диск в Google Compute Engine

```shell
curl -s https://raw.githubusercontent.com/rockstat/bootstrap/master/bin/gcloud_sdb | sudo bash -
```

### Дополнительный диск в Google Compute Engine

```shell
curl -s https://raw.githubusercontent.com/rockstat/bootstrap/master/bin/ycloud_vdb | sudo bash -
```

## Запуск установщика

Команда загрузки и запуска установщика:

```bash
curl -s https://raw.githubusercontent.com/rockstat/bootstrap/master/bin/kickstart | sudo -E bash -

Если окажется, что нет приложения `curl`, установите при помощи.

```shell
sudo apt -qqy update && sudo apt -qqy install curl
```

##
## Rockstat Bootstrap
##
## version 3.7.0
## branch master
## logs output /tmp/platform-setup.t2VTqUws
##
##...

```

Через несколько минут вам потребуется ввести домен, на котором расположен сервер, 
придумать пароль, а также указать свое имя и email (будет использовано в git).
После этого появится меню системы установки.

![menu](/static/images/docs/setup/bootstrap-menu.jpg)

Выберите пункт `03 Full Install/Upgrade` и нажмите `Enter/Return`.

[[tip]]
| Рекомендуется обновить ОС перед установкой, выбрав `01 Upgrade OS`.
| В конце обновления сервер будет перезагружен и потребуется подключиться заново.

## Проверка корректности установки

Выполним несколько простых проверок:

1. Проверим работу http и https. Зайдите на ваш трекинговый домен, например, `https://адрес-сервера`.
  Вы должны увидеть заставку Rockstat.
2. Проверим работу Front сервиса. Откройте `https://адрес-сервера/abc/def`,
  в результате выполнения Вы должны увидеть что-то вроде `{"key":"in.gen.abc.def","id":"6446133708758974464"}`.
3. Проверка состояния платформы. Перейдите на `https://app.` `адрес-сервера/`, вам откроется основной интерфейс управления
  платформой: список работающих сервисов, сводные данные по базовым событиями и пр.

![dashboard](/static/images/docs/setup/rst_dashboard.jpg)

<Footer/>

export default withDoc({...meta})(({children}) => <>{children}</>)
